#!/bin/sh
apt update;
apt install -y wget git axel python3.12 python3-pip python3-dev python3-venv zsh sudo;
update-alternatives --install /usr/bin/python python /usr/bin/python3.12 2;
update-alternatives --set python /usr/bin/python3.12;
sh -c "";
mkdir -p /workspace;
DEBIAN_FRONTEND=noninteractive apt-get install openssh-server -y;
mkdir -p ~/.ssh;
chmod 700 ~/.ssh;
echo "" >> ~/.ssh/authorized_keys;
chmod 700 ~/.ssh/authorized_keys;
service ssh start;
wget https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2404/x86_64/cuda-keyring_1.1-1_all.deb\;
dpkg -i cuda-keyring_1.1-1_all.deb;
apt-get update;
apt-get install -y cuda-toolkit;
wget https://bootstrap.pypa.io/get-pip.py -O get-pip.py;
python3 get-pip.py;
rm get-pip.py;
git clone https://github.com/Panchovix/stable-diffusion-webui-reForge.git /workspace/reforge;
cd /workspace/reforge;
python3 -m venv venv_reforge;
source venv_reforge/bin/activate;
pip install -r requirements.txt;
cat <<'EOF' > download_models.sh
cd /workspace/reforge/models/Stable-diffusion;
axel "https://civitai.com/api/download/models/934796?type=Model&format=SafeTensor&size=pruned&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/1417791?type=Model&format=SafeTensor&size=pruned&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/1407095?type=Model&format=SafeTensor&size=full&fp=bf16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/1241144?type=Model&format=SafeTensor&size=full&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/1449179?type=Model&format=SafeTensor&size=full&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/947488?type=Model&format=SafeTensor&size=full&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/1251918?type=Model&format=SafeTensor&size=full&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/1193361?type=Model&format=SafeTensor&size=pruned&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/1041855?type=Model&format=SafeTensor&size=pruned&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/720355?type=Model&format=SafeTensor&size=pruned&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/1475139?type=Model&format=SafeTensor&size=full&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/429359?type=Model&format=SafeTensor&size=full&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/1372996?type=Model&format=SafeTensor&size=pruned&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/1234200?type=Model&format=SafeTensor&size=full&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/834838?type=Model&format=SafeTensor&size=pruned&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/951424?type=Model&format=SafeTensor&size=pruned&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/1221206?type=Model&format=SafeTensor&size=pruned&fp=fp32&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/423235?type=Model&format=SafeTensor&size=pruned&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/714801?type=Model&format=SafeTensor&size=pruned&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/1514644?type=Model&format=SafeTensor&size=pruned&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/998694?type=Model&format=SafeTensor&size=full&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/998694?type=Model&format=SafeTensor&size=full&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/998694?type=Model&format=SafeTensor&size=full&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/522165?type=Model&format=SafeTensor&size=full&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/1097040?type=Model&format=SafeTensor&size=pruned&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/738965?type=Model&format=SafeTensor&size=pruned&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/930779?type=Model&format=SafeTensor&size=pruned&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/421137?type=Model&format=SafeTensor&size=full&fp=fp32&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/515453?type=Model&format=SafeTensor&size=pruned&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/395107?type=Model&format=SafeTensor&size=pruned&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/345685?type=Model&format=SafeTensor&size=full&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/299716?type=Model&format=SafeTensor&size=full&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;
axel "https://civitai.com/api/download/models/958003?type=Model&format=SafeTensor&size=pruned&fp=fp16&?&token=9dca6f30e0b52ae663be7ffb0e15a4c2"\;'
'
